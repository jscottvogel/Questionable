{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nconst proxyHost = '127.0.0.1';\nconst proxyPort = 3500;\n\n// Proxy URL\nconst proxyUrl = `http://${proxyHost}:${proxyPort}`;\nconst initialState = [];\nconst eventsSlice = createSlice({\n  name: 'events',\n  initialState: {\n    events: initialState\n  },\n  reducers: {\n    loadEvents: (state, action) => {\n      // check to see if there are any new events\n      // if so, add them to the state\n      // if not, do nothing\n      if (state.events.length === 0) {\n        state.events = action.payload;\n      } else {\n        let temp = state.events.filter(event => event.id !== action.payload.id);\n        if (temp.length !== state.events.length) {\n          state.events = action.payload;\n        }\n      }\n    },\n    addEvent: (state, action) => {\n      let evt = action.payload;\n      if (evt !== null) {\n        state.events.push(evt);\n      }\n    },\n    deleteEvent: (state, action) => {\n      const eventId = action.payload;\n      state.events = state.events.filter(event => event.id !== eventId);\n    }\n  }\n});\n\n// Write a function that has `dispatch` and `getState` as arguments\nconst fetchEvents = (dispatch, getState) => {\n  // Make an async HTTP request\n  return fetch('http://127.0.0.1:3500/events', {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    cache: \"no-cache\" // *default, no-cache, reload, force-cache, only-if-cached\n  }).then(res => {\n    //console.log( res );\n    const evts = res.json();\n    //console.log( evts );\n    return evts;\n  }).then(evts => {\n    dispatch({\n      type: \"events/loadEvents\",\n      payload: evts\n    });\n  }).catch(err => console.log(err));\n  // todo, error condition\n};\n\nfunction removeEvent(id, dispatch) {\n  //console.log( \"deleteEvent: \" + id );\n  return fetch(`http://127.0.0.1:3500/event/${id}`, {\n    method: \"DELETE\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    cache: \"no-cache\" // *default, no-cache, reload, force-cache, only-if-cached\n  }).then(response => {\n    if (response.ok) {\n      dispatch({\n        type: \"events/deleteEvent\",\n        payload: id\n      });\n    } else {\n      console.log(response);\n      console.log(\"Event not deleted\");\n    }\n  }).catch(error => {\n    console.log(error);\n  });\n}\nfunction addNewEvent(newEvent, dispatch) {\n  return fetch(`http://\n${proxyHost}:${proxyPort}/event`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    cache: \"no-cache\",\n    // *default, no-cache, reload, force-cache, only-if-cached\n    body: JSON.stringify(newEvent)\n  }).then(response => {\n    if (response.ok) {\n      dispatch({\n        type: \"events/addEvent\",\n        payload: newEvent\n      });\n      return response.json();\n    } else {\n      console.log(response);\n      console.log(\"Event not added\");\n      return null;\n    }\n  }).catch(error => {\n    console.log(error);\n    return null;\n  });\n}\nexport const {\n  loadEvents,\n  addEvent,\n  deleteEvent\n} = eventsSlice.actions;\nexport { fetchEvents, removeEvent, addNewEvent };\nexport default eventsSlice.reducer;","map":{"version":3,"names":["createSlice","proxyHost","proxyPort","proxyUrl","initialState","eventsSlice","name","events","reducers","loadEvents","state","action","length","payload","temp","filter","event","id","addEvent","evt","push","deleteEvent","eventId","fetchEvents","dispatch","getState","fetch","method","headers","cache","then","res","evts","json","type","catch","err","console","log","removeEvent","response","ok","error","addNewEvent","newEvent","body","JSON","stringify","actions","reducer"],"sources":["/home/fred/Questionable/questionable-client/src/features/events/eventsSlice.js"],"sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\n\nconst proxyHost = '127.0.0.1';\nconst proxyPort = 3500;\n\n// Proxy URL\nconst proxyUrl = `http://${ proxyHost }:${ proxyPort }`;\n\nconst initialState = [];\n\nconst eventsSlice = createSlice( {\n    name: 'events',\n    initialState: {\n        events: initialState\n    },\n    reducers: {\n        loadEvents: ( state, action ) => {\n            // check to see if there are any new events\n            // if so, add them to the state\n            // if not, do nothing\n            if ( state.events.length === 0 ) {\n                state.events = action.payload;\n            } else {\n                let temp = state.events.filter( event => event.id !== action.payload.id );\n                if ( temp.length !== state.events.length ) {\n                    state.events = action.payload;\n                }\n            }\n        },\n        addEvent: ( state, action ) => {\n            let evt = action.payload;\n\n            if ( evt !== null ) {\n                state.events.push( evt );\n            }\n        },\n        deleteEvent: ( state, action ) => {\n            const eventId = action.payload;\n            state.events = state.events.filter( event => event.id !== eventId );\n        }\n    }\n} );\n\n// Write a function that has `dispatch` and `getState` as arguments\nconst fetchEvents = ( dispatch, getState ) => {\n    // Make an async HTTP request\n    return fetch( 'http://127.0.0.1:3500/events', {\n        method: \"GET\",\n        headers: { \"Content-Type\": \"application/json\" },\n        cache: \"no-cache\" // *default, no-cache, reload, force-cache, only-if-cached\n    } ).then( res => {\n        //console.log( res );\n        const evts = res.json();\n        //console.log( evts );\n        return evts;\n    } ).then( evts => {\n        dispatch( { type: \"events/loadEvents\", payload: evts } );\n    } ).catch( err => console.log( err ) );\n    // todo, error condition\n\n}\n\nfunction removeEvent( id, dispatch ) {\n    //console.log( \"deleteEvent: \" + id );\n    return fetch( `http://127.0.0.1:3500/event/${ id }`, {\n        method: \"DELETE\",\n        headers: { \"Content-Type\": \"application/json\" },\n        cache: \"no-cache\" // *default, no-cache, reload, force-cache, only-if-cached\n    } )\n        .then( response => {\n            if ( response.ok ) {\n                dispatch( { type: \"events/deleteEvent\", payload: id } );\n            } else {\n                console.log( response );\n                console.log( \"Event not deleted\" );\n            }\n        } )\n        .catch( error => {\n            console.log( error );\n        } );\n}\n\nfunction addNewEvent( newEvent, dispatch ) {\n    return fetch( `http://\n${ proxyHost }:${ proxyPort }/event`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n        body: JSON.stringify( newEvent )\n    } )\n        .then( response => {\n            if ( response.ok ) {\n                dispatch( { type: \"events/addEvent\", payload: newEvent } );\n                return response.json();\n            } else {\n                console.log( response );\n                console.log( \"Event not added\" );\n                return null;\n            }\n        } )\n        .catch( error => {\n            console.log( error );\n            return null;\n        } );\n}\n\nexport const { loadEvents, addEvent, deleteEvent } = eventsSlice.actions;\n\nexport { fetchEvents, removeEvent, addNewEvent };\n\nexport default eventsSlice.reducer;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}